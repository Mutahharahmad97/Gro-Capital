{"ast":null,"code":"var _jsxFileName = \"/home/mutahharahmadpersonal/Development/Gro Pakistan/Current/grocapitalapp-react/src/components/Popups/PhonePopup.jsx\",\n    _s = $RefreshSig$();\n\nimport { useState, useRef, useContext } from \"react\";\nimport { AppControlContext } from \"../../context/AppControlContext\";\nimport { sendSms } from \"../../services/sendSms\";\nimport { useHistory } from \"react-router-dom\";\nimport register from \"../../services/Auth/userRegister\";\nimport createUserProfile from \"../../services/Forms/createUserProfile\";\nimport patchFormStep from \"../../services/Forms/patchFormStep\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst PhonePopup = props => {\n  _s();\n\n  const history = useHistory();\n  const {\n    Form,\n    setLoginPopupState,\n    setGlobalErrorMessage\n  } = useContext(AppControlContext);\n  const {\n    setFormStep\n  } = useContext(AppControlContext);\n  const {\n    pinGenerated,\n    setPinGenerated\n  } = useContext(AppControlContext);\n  const [passCode, setPassCode] = useState({\n    pin1: \"\",\n    pin2: \"\",\n    pin3: \"\",\n    pin4: \"\"\n  });\n  const pin1 = useRef();\n  const pin2 = useRef();\n  const pin3 = useRef();\n  const pin4 = useRef();\n  const popupState = props.popupState ? \"popup active\" : \"popup\";\n  const phone = props.phone;\n\n  const onConfirm = async () => {\n    const pinEntered = passCode.pin1 + passCode.pin2 + passCode.pin3 + passCode.pin4;\n\n    if (pinEntered === pinGenerated + \"\") {\n      const userRegister = await register(Form);\n\n      if (!userRegister.success) {\n        if (userRegister.userExists) {\n          setLoginPopupState(true);\n          setGlobalErrorMessage(\"User Already exists! Please login.\");\n          history.push(\"/\");\n        } else {\n          props.setApiErrorMessage(userRegister.message);\n          props.setApiErrorState(true);\n          props.onClose();\n        }\n      } else {\n        const createUser = await createUserProfile(Form);\n\n        if (!createUser.success) {\n          props.setApiErrorMessage(createUser.message);\n          props.setApiErrorState(true);\n          props.onClose();\n        } else {\n          const patchFormStep_ = await patchFormStep(1);\n\n          if (!patchFormStep_.success) {\n            props.setApiErrorMessage(patchFormStep_.message);\n            props.setApiErrorState(true);\n            props.onClose();\n          } else {\n            setFormStep(1);\n            history.push(\"/registration\");\n          }\n        }\n      }\n    } else alert(\"Wrong Pin Entered\");\n  };\n\n  const onResend = async () => {\n    const randomPinGenerator = Math.floor(Math.random() * (9726 - 1368)) + 1368;\n    setPinGenerated(randomPinGenerator);\n    await sendSms(Form.Phone, randomPinGenerator);\n  };\n\n  const pinEntered = async e => {\n    /^[0-9]+$/.test(e.target.value) || e.target.value.length === 0 ? setPassCode({ ...passCode,\n      [e.target.name]: e.target.value\n    }) : await setPassCode({ ...passCode\n    });\n\n    switch (e.target.name) {\n      case \"pin1\":\n        e.target.value === \"\" ? pin1.current.focus() : pin2.current.focus();\n        break;\n\n      case \"pin2\":\n        e.target.value === \"\" ? pin2.current.focus() : pin3.current.focus();\n        break;\n\n      case \"pin3\":\n        e.target.value === \"\" ? pin3.current.focus() : pin4.current.focus();\n        break;\n\n      case \"pin4\":\n        if (passCode.pin1.length > 0 && passCode.pin2.length > 0 && passCode.pin3.length > 0) {\n          // onConfirm();\n          alert(\"pin 4 done\");\n        } else {\n          props.setApiErrorMessage(\"Please enter 4 digits pin\");\n          props.setApiErrorState(true);\n        }\n\n        break;\n\n      default: //Do Nothing\n\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"popup-number\",\n    className: popupState,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"popup__box\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"popup__item popup__item--sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"popup__close\",\n          onClick: props.onClose,\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            width: \"15\",\n            height: \"15\",\n            viewBox: \"0 0 15 15\",\n            children: /*#__PURE__*/_jsxDEV(\"g\", {\n              transform: \"translate(.414 .414)\",\n              children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M12.2928932,0.292893219 C12.6834175,-0.0976310729 13.3165825,-0.0976310729 13.7071068,0.292893219 C14.0675907,0.65337718 14.0953203,1.22060824 13.7902954,1.61289944 L13.7071068,1.70710678 L1.70710678,13.7071068 C1.31658249,14.0976311 0.683417511,14.0976311 0.292893219,13.7071068 C-0.0675907428,13.3466228 -0.0953202783,12.7793918 0.209704612,12.3871006 L0.292893219,12.2928932 L12.2928932,0.292893219 Z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 121,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M0.292893219,0.292893219 C0.65337718,-0.0675907428 1.22060824,-0.0953202783 1.61289944,0.209704612 L1.70710678,0.292893219 L13.7071068,12.2928932 C14.0976311,12.6834175 14.0976311,13.3165825 13.7071068,13.7071068 C13.3466228,14.0675907 12.7793918,14.0953203 12.3871006,13.7902954 L12.2928932,13.7071068 L0.292893219,1.70710678 C-0.0976310729,1.31658249 -0.0976310729,0.683417511 0.292893219,0.292893219 Z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"popup__title popup__title--center\",\n          children: [\"Confirm your\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 13\n          }, this), \"phone number\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"popup__txt\",\n          children: [\"We send a 4-digit pass code to ******\", phone.substring(phone.length - 3, phone.length), \".\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 13\n          }, this), \" Please enter this code below.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-3\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                name: \"pin1\",\n                onChange: pinEntered,\n                ref: pin1,\n                maxLength: \"1\",\n                value: passCode.pin1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-3\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                name: \"pin2\",\n                onChange: pinEntered,\n                ref: pin2,\n                maxLength: \"1\",\n                value: passCode.pin2\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-3\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                name: \"pin3\",\n                onChange: pinEntered,\n                ref: pin3,\n                maxLength: \"1\",\n                value: passCode.pin3\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-3\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                name: \"pin4\",\n                onChange: pinEntered,\n                ref: pin4,\n                maxLength: \"1\",\n                value: passCode.pin4\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 175,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"popup__txt\",\n          style: {\n            fontSize: \"11px\"\n          },\n          children: \"Use one time for verification purposes only.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: onResend,\n          className: \"btn btn--green-thin btn--full btn--mb\",\n          children: \"Resend\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"popup__bg\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 110,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PhonePopup, \"FobaUVYh/Q3R2BksWAZEVlZ7pJs=\", false, function () {\n  return [useHistory];\n});\n\n_c = PhonePopup;\nexport default PhonePopup;\n\nvar _c;\n\n$RefreshReg$(_c, \"PhonePopup\");","map":{"version":3,"sources":["/home/mutahharahmadpersonal/Development/Gro Pakistan/Current/grocapitalapp-react/src/components/Popups/PhonePopup.jsx"],"names":["useState","useRef","useContext","AppControlContext","sendSms","useHistory","register","createUserProfile","patchFormStep","PhonePopup","props","history","Form","setLoginPopupState","setGlobalErrorMessage","setFormStep","pinGenerated","setPinGenerated","passCode","setPassCode","pin1","pin2","pin3","pin4","popupState","phone","onConfirm","pinEntered","userRegister","success","userExists","push","setApiErrorMessage","message","setApiErrorState","onClose","createUser","patchFormStep_","alert","onResend","randomPinGenerator","Math","floor","random","Phone","e","test","target","value","length","name","current","focus","substring","fontSize"],"mappings":"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","sourcesContent":["import { useState, useRef, useContext } from \"react\";\nimport { AppControlContext } from \"../../context/AppControlContext\";\nimport { sendSms } from \"../../services/sendSms\";\nimport { useHistory } from \"react-router-dom\";\nimport register from \"../../services/Auth/userRegister\";\nimport createUserProfile from \"../../services/Forms/createUserProfile\";\nimport patchFormStep from \"../../services/Forms/patchFormStep\";\n\nconst PhonePopup = (props) => {\n  const history = useHistory();\n  const { Form, setLoginPopupState, setGlobalErrorMessage } =\n    useContext(AppControlContext);\n  const { setFormStep } = useContext(AppControlContext);\n  const { pinGenerated, setPinGenerated } = useContext(AppControlContext);\n  const [passCode, setPassCode] = useState({\n    pin1: \"\",\n    pin2: \"\",\n    pin3: \"\",\n    pin4: \"\",\n  });\n  const pin1 = useRef();\n  const pin2 = useRef();\n  const pin3 = useRef();\n  const pin4 = useRef();\n\n  const popupState = props.popupState ? \"popup active\" : \"popup\";\n  const phone = props.phone;\n\n  const onConfirm = async () => {\n    const pinEntered =\n      passCode.pin1 + passCode.pin2 + passCode.pin3 + passCode.pin4;\n    if (pinEntered === pinGenerated + \"\") {\n      const userRegister = await register(Form);\n\n      if (!userRegister.success) {\n        if (userRegister.userExists) {\n          setLoginPopupState(true);\n          setGlobalErrorMessage(\"User Already exists! Please login.\");\n          history.push(\"/\");\n        } else {\n          props.setApiErrorMessage(userRegister.message);\n          props.setApiErrorState(true);\n          props.onClose();\n        }\n      } else {\n        const createUser = await createUserProfile(Form);\n        if (!createUser.success) {\n          props.setApiErrorMessage(createUser.message);\n          props.setApiErrorState(true);\n          props.onClose();\n        } else {\n          const patchFormStep_ = await patchFormStep(1);\n          if (!patchFormStep_.success) {\n            props.setApiErrorMessage(patchFormStep_.message);\n            props.setApiErrorState(true);\n            props.onClose();\n          } else {\n            setFormStep(1);\n            history.push(\"/registration\");\n          }\n        }\n      }\n    } else alert(\"Wrong Pin Entered\");\n  };\n\n  const onResend = async () => {\n    const randomPinGenerator = Math.floor(Math.random() * (9726 - 1368)) + 1368;\n    setPinGenerated(randomPinGenerator);\n    await sendSms(Form.Phone, randomPinGenerator);\n  };\n\n  const pinEntered = async (e) => {\n    /^[0-9]+$/.test(e.target.value) || e.target.value.length === 0\n      ? setPassCode({\n          ...passCode,\n          [e.target.name]: e.target.value,\n        })\n      : await setPassCode({ ...passCode });\n\n    switch (e.target.name) {\n      case \"pin1\":\n        e.target.value === \"\" ? pin1.current.focus() : pin2.current.focus();\n        break;\n\n      case \"pin2\":\n        e.target.value === \"\" ? pin2.current.focus() : pin3.current.focus();\n        break;\n\n      case \"pin3\":\n        e.target.value === \"\" ? pin3.current.focus() : pin4.current.focus();\n        break;\n\n      case \"pin4\":\n        if(passCode.pin1.length > 0 && passCode.pin2.length > 0 && passCode.pin3.length > 0) {\n          // onConfirm();\n          alert(\"pin 4 done\");\n        }\n        else {\n          props.setApiErrorMessage(\"Please enter 4 digits pin\");\n          props.setApiErrorState(true);\n        }\n        break;\n\n      default:\n      //Do Nothing\n    }\n  };\n\n  return (\n    <div id=\"popup-number\" className={popupState}>\n      <div className=\"popup__box\">\n        <div className=\"popup__item popup__item--sm\">\n          <div className=\"popup__close\" onClick={props.onClose}>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"15\"\n              height=\"15\"\n              viewBox=\"0 0 15 15\"\n            >\n              <g transform=\"translate(.414 .414)\">\n                <path d=\"M12.2928932,0.292893219 C12.6834175,-0.0976310729 13.3165825,-0.0976310729 13.7071068,0.292893219 C14.0675907,0.65337718 14.0953203,1.22060824 13.7902954,1.61289944 L13.7071068,1.70710678 L1.70710678,13.7071068 C1.31658249,14.0976311 0.683417511,14.0976311 0.292893219,13.7071068 C-0.0675907428,13.3466228 -0.0953202783,12.7793918 0.209704612,12.3871006 L0.292893219,12.2928932 L12.2928932,0.292893219 Z\" />\n                <path d=\"M0.292893219,0.292893219 C0.65337718,-0.0675907428 1.22060824,-0.0953202783 1.61289944,0.209704612 L1.70710678,0.292893219 L13.7071068,12.2928932 C14.0976311,12.6834175 14.0976311,13.3165825 13.7071068,13.7071068 C13.3466228,14.0675907 12.7793918,14.0953203 12.3871006,13.7902954 L12.2928932,13.7071068 L0.292893219,1.70710678 C-0.0976310729,1.31658249 -0.0976310729,0.683417511 0.292893219,0.292893219 Z\" />\n              </g>\n            </svg>\n          </div>\n          <div className=\"popup__title popup__title--center\">\n            Confirm your\n            <br />\n            phone number\n          </div>\n          <div className=\"popup__txt\">\n            We send a 4-digit pass code to ******\n            {phone.substring(phone.length - 3, phone.length)}.\n            <br /> Please enter this code below.\n          </div>\n          <div className=\"row\">\n            <div className=\"col-3\">\n              <div className=\"form-group\">\n                <input\n                  type=\"text\"\n                  name=\"pin1\"\n                  onChange={pinEntered}\n                  ref={pin1}\n                  maxLength=\"1\"\n                  value={passCode.pin1}\n                />\n              </div>\n            </div>\n            <div className=\"col-3\">\n              <div className=\"form-group\">\n                <input\n                  type=\"text\"\n                  name=\"pin2\"\n                  onChange={pinEntered}\n                  ref={pin2}\n                  maxLength=\"1\"\n                  value={passCode.pin2}\n                />\n              </div>\n            </div>\n            <div className=\"col-3\">\n              <div className=\"form-group\">\n                <input\n                  type=\"text\"\n                  name=\"pin3\"\n                  onChange={pinEntered}\n                  ref={pin3}\n                  maxLength=\"1\"\n                  value={passCode.pin3}\n                />\n              </div>\n            </div>\n            <div className=\"col-3\">\n              <div className=\"form-group\">\n                <input\n                  type=\"text\"\n                  name=\"pin4\"\n                  onChange={pinEntered}\n                  ref={pin4}\n                  maxLength=\"1\"\n                  value={passCode.pin4}\n                />\n              </div>\n            </div>\n          </div>\n          <div className=\"popup__txt\" style={{ fontSize: \"11px\" }}>\n            Use one time for verification purposes only.\n          </div>\n          <div\n            onClick={onResend}\n            className=\"btn btn--green-thin btn--full btn--mb\"\n          >\n            Resend\n          </div>\n          {/* <div onClick={onConfirm} className=\"btn btn--green btn--full\">\n            Confirm\n          </div> */}\n        </div>\n        <div className=\"popup__bg\"></div>\n      </div>\n    </div>\n  );\n};\n\nexport default PhonePopup;\n"]},"metadata":{},"sourceType":"module"}